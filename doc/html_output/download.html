
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <title>Download as Excel</title>
</head>
<body>
    <div class="container">
        <h1>Download all tables as Excel</h1>
        <button id='download-button' class='btn btn-primary'>Download as Excel</button>
    </div>
    <script>
        document.getElementById('download-button').addEventListener('click', function () {
            var wb = XLSX.utils.book_new();

            // Add sheets for background data
            var ecoinventTable = document.querySelector('#BackgroundDB_SourceDatasets_ecoinvent');
            var gabiTable = document.querySelector('#BackgroundDB_SourceDatasets_GaBi');
            if (ecoinventTable) {
                var ecoinventWS = XLSX.utils.table_to_sheet(ecoinventTable);
                XLSX.utils.book_append_sheet(wb, ecoinventWS, 'BackgroundDB_SourceDatasets_ecoinvent');
            }
            if (gabiTable) {
                var gabiWS = XLSX.utils.table_to_sheet(gabiTable);
                XLSX.utils.book_append_sheet(wb, gabiWS, 'BackgroundDB_SourceDatasets_GaBi');
            }

            // Add sheets for indicators
            var commonRefsTable = document.querySelector('#Common_references');
            var countrySpecificTable = document.querySelector('#Country_specific_indicators');
            var en15804A1Table = document.querySelector('#EN15804+A1_indicators');
            var en15804A2Table = document.querySelector('#EN15804+A2_indicators');
            var flowPropsTable = document.querySelector('#Flow_properties_and_unit_groups');
            if (commonRefsTable) {
                var commonRefsWS = XLSX.utils.table_to_sheet(commonRefsTable);
                XLSX.utils.book_append_sheet(wb, commonRefsWS, 'Common_references');
            }
            if (countrySpecificTable) {
                var countrySpecificWS = XLSX.utils.table_to_sheet(countrySpecificTable);
                XLSX.utils.book_append_sheet(wb, countrySpecificWS, 'Country_specific_indicators');
            }
            if (en15804A1Table) {
                var en15804A1WS = XLSX.utils.table_to_sheet(en15804A1Table);
                XLSX.utils.book_append_sheet(wb, en15804A1WS, 'EN15804+A1_indicators');
            }
            if (en15804A2Table) {
                var en15804A2WS = XLSX.utils.table_to_sheet(en15804A2Table);
                XLSX.utils.book_append_sheet(wb, en15804A2WS, 'EN15804+A2_indicators');
            }
            if (flowPropsTable) {
                var flowPropsWS = XLSX.utils.table_to_sheet(flowPropsTable);
                XLSX.utils.book_append_sheet(wb, flowPropsWS, 'Flow_properties_and_unit_groups');
            }

            XLSX.writeFile(wb, 'Converted_CSVs.xlsx');
        });
    </script>
</body>
</html>
